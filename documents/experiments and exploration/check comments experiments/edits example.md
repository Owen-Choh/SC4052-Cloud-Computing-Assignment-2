```json
{
  "file": "github-search-saas/src/utils/apiUtils.ts",
  "edits": [
    {
      "start": 3,
      "end": 28,
      "replacement": "/**\n * Fetches the content of multiple files from GitHub.\n *\n * @param results An array of search result items, each containing repository and path information.\n * @param token GitHub token for authentication.\n * @returns An object containing the concatenated file contents, a map of file paths to their contents, and any error messages.\n */\nexport const fetchFileContents = async (results: any[], token: string): Promise<{ fileContents: string; fileContentMap: Map<string, string>; errmsg: string; }> => {\n  let fileContents = \"\";\n  let fileContentMap = new Map<string, string>();\n  let errmsg = \"\";\n\n  for (const item of results) {\n    try {\n      const response = await githubGetCodeApi.get(\n        `/${item.repository.full_name}/contents/${item.path}`,\n        {\n          headers: {\n            Authorization: `Bearer ${token || GITHUB_TOKEN}`,\n          },\n        }\n      );\n      const fileContent = atob(response.data.content);\n      fileContents += item.path + \"\\n\" + fileContent + \"\\n\\n\";\n      fileContentMap.set(item.path, fileContent);\n    } catch (error) {\n      console.error(`Error fetching file content for ${item.path}: ${error}`);\n      errmsg += item.path + \"; \";\n    }\n  }\n\n  return { fileContents, fileContentMap, errmsg };\n};\n"
    },
    {
      "start": 30,
      "end": 189,
      "replacement": "/**\n * Submits a pull request to a GitHub repository with the given file changes.\n *\n * @param username The username of the repository owner.\n * @param repository The name of the repository.\n * @param token GitHub token for authentication.\n * @param files An array of file objects, each containing the file path and content.\n * @param commitMessage The message for the commit.\n * @param branchName The name of the branch to create for the pull request.\n * @param pullRequestTitle The title of the pull request.\n * @param pullRequestBody The body of the pull request.\n * @returns An object containing the result message and any error messages.\n */\nexport const submitPullRequest = async (\n  username: string,\n  repository: string,\n  token: string,\n  files: { filePath: string; fileContent: string }[],\n  commitMessage: string,\n  branchName: string,\n  pullRequestTitle: string,\n  pullRequestBody: string\n): Promise<{ result: string; errmsg: string }> => {\n  var errmessage = \"\";\n  console.log(\"Checking pull request parameters...\");\n  if (!files || files.length === 0) {\n    return { result: \"pull request aborted\", errmsg: \"error: no content to submit for pull request\" };\n  }\n  if (files.some((file) => !file.filePath || !file.fileContent)) {\n    return { result: \"pull request aborted\", errmsg: \"error: file paths or file contents are empty\" };\n  }\n  if (commitMessage === \"\") {\n    console.log(\"Default commit message used as no commit message provided.\");\n    commitMessage = \"Default commit message from github search saas\";\n    errmessage += \"error: default commit message used as no commit message provided\\n\";\n  }\n  branchName = branchName.replace(/[^a-zA-Z0-9-_]/g, \"-\");\n  console.log(\"branch name sanitized: \", branchName);\n  if (!branchName || branchName === \"\") {\n    console.log(\n      \"Default branch name used as no branch name after sanitizing.\"\n    );\n    branchName = \"default-branch-name\";\n    errmessage += \"error: default branch name used as no branch name after sanitizing\\n\";\n  }\n  if (!pullRequestTitle || pullRequestTitle === \"\") {\n    console.log(\n      \"Default pull request title used as no pull request title provided.\"\n    );\n    errmessage +=\n      \"error: default pull request title used as no pull request title provided\\n\";\n    pullRequestTitle = \"Generated output from github search saas\";\n  }\n  if (!pullRequestBody || pullRequestBody === \"\") {\n    console.log(\n      \"Default pull request body used as no pull request body provided.\"\n    );\n    errmessage +=\n      \"error: default pull request body used as no pull request body provided\\n\"\n      ;\n    pullRequestBody = \"This is the generated output from github search saas\";\n  }\n\n  try {\n    const defaultBranchResponse = await githubGetCodeApi.get(\n      `/${username}/${repository}`,\n      {\n        headers: {\n          Authorization: `Bearer ${token || GITHUB_TOKEN}`,\n        },\n      }\n    );\n    const defaultBranch = defaultBranchResponse.data.default_branch;\n\n    const commitAndTreeResponse = await githubGetCodeApi.get(\n      `/${username}/${repository}/branches/${defaultBranch}`,\n      {\n        headers: {\n          Authorization: `Bearer ${token || GITHUB_TOKEN}`,\n        },\n      }\n    );\n    const oldCommit = commitAndTreeResponse.data.commit.sha;\n    const oldTree = commitAndTreeResponse.data.commit.commit.tree.sha;\n\n    let newTree = oldTree;\n    let newCommit = oldCommit;\n\n    for (const { filePath, fileContent } of files) {\n      const newTreeResponse = await githubGetCodeApi.post(\n        `/${username}/${repository}/git/trees`,\n        {\n          base_tree: newTree,\n          tree: [\n            {\n              path: filePath,\n              mode: \"100644\",\n              type: \"blob\",\n              content: fileContent,\n            },\n          ],\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${token || GITHUB_TOKEN}`,\n          },\n        }\n      );\n      newTree = newTreeResponse.data.sha;\n    }\n\n    const newCommitResponse = await githubGetCodeApi.post(\n      `/${username}/${repository}/git/commits`,\n      {\n        message: commitMessage,\n        tree: newTree,\n        parents: [newCommit],\n      },\n      {\n        headers: {\n          Authorization: `Bearer ${token || GITHUB_TOKEN}`,\n        },\n      }\n    );\n    newCommit = newCommitResponse.data.sha;\n\n    const newBranchName = branchName + Date.now();\n    await githubGetCodeApi.post(\n      `/${username}/${repository}/git/refs`,\n      {\n        ref: `refs/heads/${newBranchName}`,\n        sha: newCommit,\n      },\n      {\n        headers: {\n          Authorization: `Bearer ${token || GITHUB_TOKEN}`,\n        },\n      }\n    );\n\n    const pullRequestResponse = await githubGetCodeApi.post(\n      `/${username}/${repository}/pulls`,\n      {\n        title: pullRequestTitle,\n        body: pullRequestBody,\n        head: newBranchName,\n        base: defaultBranch,\n      },\n      {\n        headers: {\n          Authorization: `Bearer ${token || GITHUB_TOKEN}`,\n        },\n      }\n    );\n    console.log(\"Pull request response: \", pullRequestResponse.data);\n\n    return { result: \"Pull request submitted successfully!\", errmsg: errmessage };\n  } catch (error) {\n    console.error(\"Error submitting pull request: \", error);\n    errmessage += \"error: error when submitting pull request:\" + error;\n    return { result: \"Pull request submission failed\", errmsg: errmessage };\n  }\n};\n"
    }
  ]
}
```